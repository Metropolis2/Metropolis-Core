{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Parameters_for_double",
  "description": "Set of parameters used to control how a [Simulation](crate::simulation::Simulation) is run.",
  "examples": [
    {
      "learning_model": {
        "type": "Exponential",
        "value": {
          "alpha": 0.9
        }
      },
      "network": {
        "road_network": {
          "contraction": {
            "complexity_quotient_weight": 2.0,
            "edge_quotient_weight": 2.0,
            "hierarchy_depth_weight": 1.0,
            "num_threads": 8,
            "thin_profile_interval_hop_limit": 16,
            "unpacked_edges_quotient_weight": 1.0
          },
          "overlay_simplification": {
            "type": "Raw"
          },
          "recording_interval": 60.0,
          "search_space_simplification": {
            "type": "Raw"
          },
          "simulated_simplification": {
            "type": "Raw"
          },
          "weight_simplification": {
            "type": "Raw"
          }
        }
      },
      "period": [
        21600.0,
        43200.0
      ],
      "random_seed": 13081996,
      "stopping_criteria": [
        {
          "type": "MaxIteration",
          "value": 100
        },
        {
          "type": "DepartureTime",
          "value": [
            2.0,
            3600.0
          ]
        }
      ],
      "update_ratio": 1.0
    }
  ],
  "type": "object",
  "required": [
    "network",
    "period",
    "stopping_criteria"
  ],
  "properties": {
    "learning_model": {
      "description": "Learning model used to update the values between two iterations.",
      "allOf": [
        {
          "$ref": "#/definitions/LearningModel_for_double"
        }
      ]
    },
    "network": {
      "description": "Set of parameters for the network.",
      "allOf": [
        {
          "$ref": "#/definitions/NetworkParameters_for_double"
        }
      ]
    },
    "period": {
      "description": "Time interval used to restrict the travel-time functions of the edges.\n\nThe departure-time intervals of the agents must be included in this interval.\n\nAgents can still travel on the network when the period is exceeded but the edges' travel times are no longer recorded. The departure time chosen by any agent must be such that the expected arrival time is earlier than the end of the period.",
      "allOf": [
        {
          "$ref": "#/definitions/Interval_for_double"
        }
      ]
    },
    "random_seed": {
      "description": "Random seed used for all the draws.\n\nIf `null`, the seed is generated by entropy.",
      "default": null,
      "type": "integer",
      "format": "uint64",
      "minimum": 0.0,
      "nullable": true
    },
    "stopping_criteria": {
      "description": "Set of stopping criteria used to decide when the iterative process should stop.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/StopCriterion_for_double"
      }
    },
    "update_ratio": {
      "description": "Share of agents that can update their pre-day choices at each iteration.",
      "default": 1.0,
      "type": "number",
      "format": "double",
      "maximum": 1.0,
      "minimum": 0.0
    }
  },
  "definitions": {
    "ContractionParameters": {
      "title": "Contraction Parameters",
      "description": "Set of parameters used when contracting a graph. See Batz, Geisberger, Sanders and Vetter (2013) for a description of the parameters.",
      "type": "object",
      "required": [
        "complexity_quotient_weight",
        "edge_quotient_weight",
        "hierarchy_depth_weight",
        "num_threads",
        "thin_profile_interval_hop_limit",
        "unpacked_edges_quotient_weight"
      ],
      "properties": {
        "complexity_quotient_weight": {
          "type": "number",
          "format": "double"
        },
        "edge_quotient_weight": {
          "type": "number",
          "format": "double"
        },
        "hierarchy_depth_weight": {
          "type": "number",
          "format": "double"
        },
        "num_threads": {
          "description": "Number of threads to use for the parallelized parts of the code.",
          "type": "integer",
          "format": "uint",
          "minimum": 0.0
        },
        "thin_profile_interval_hop_limit": {
          "type": "integer",
          "format": "uint8",
          "minimum": 0.0
        },
        "unpacked_edges_quotient_weight": {
          "type": "number",
          "format": "double"
        }
      }
    },
    "ExponentialLearningModel_for_double": {
      "description": "An exponential learning model.\n\nThe average value at iteration `T`, `x_T`, is a mean of the update values `y_t` at each iteration `t`, where the coefficient of the update value `y_t` is `(1 - alpha) * alpha^(T - t) / (1 - alpha^T)`.\n\nWhen `T` is large, the exponential learning model is such that `x_{t+1} = alpha * x_t + (1 - alpha) * y_{t+1}`",
      "type": "object",
      "required": [
        "alpha"
      ],
      "properties": {
        "alpha": {
          "description": "Weight of the old value, between 0 and 1.",
          "type": "number",
          "format": "double",
          "maximum": 1.0,
          "minimum": 0.0
        }
      }
    },
    "Interval_for_double": {
      "title": "Interval",
      "description": "Interval of time.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/Time_for_double"
      },
      "maxItems": 2,
      "minItems": 2
    },
    "LearningModel_for_double": {
      "description": "A learning model that specifies how to compute the new value `x_{t+1}`, given the old value `x_t` and an update value `y`. value.",
      "oneOf": [
        {
          "description": "Exponential learning model.",
          "type": "object",
          "required": [
            "type",
            "value"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Exponential"
              ]
            },
            "value": {
              "$ref": "#/definitions/ExponentialLearningModel_for_double"
            }
          }
        },
        {
          "description": "Linear learning model: `x_{t+1} = (t / (t + 1)) * x_t + (1 / (t + 1)) * y`",
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Linear"
              ]
            }
          }
        },
        {
          "description": "Genetic learning model: `x_{t+1} = (x_t^t * y)^(1 / (t + 1))`",
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Genetic"
              ]
            }
          }
        },
        {
          "description": "Quadratic learning model: `x_{t+1} = (w / (w + 1)) * x_t + (1 / (w + 1)) * y` where `w = t^(1/2)`",
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Quadratic"
              ]
            }
          }
        }
      ]
    },
    "NetworkParameters_for_double": {
      "description": "Parameters of the simulation that are specific to the network.",
      "type": "object",
      "properties": {
        "road_network": {
          "description": "Parameters specific to the road network.",
          "allOf": [
            {
              "$ref": "#/definitions/RoadNetworkParameters_for_double"
            }
          ],
          "nullable": true
        }
      }
    },
    "RoadNetworkParameters_for_double": {
      "title": "Road Network Parameters",
      "description": "Set of parameters related to a road network.",
      "type": "object",
      "required": [
        "recording_interval"
      ],
      "properties": {
        "contraction": {
          "description": "Parameters controlling how a hierarchy overlay is built from a road network graph.",
          "default": {
            "complexity_quotient_weight": 2.0,
            "edge_quotient_weight": 2.0,
            "hierarchy_depth_weight": 1.0,
            "num_threads": 8,
            "thin_profile_interval_hop_limit": 16,
            "unpacked_edges_quotient_weight": 1.0
          },
          "allOf": [
            {
              "$ref": "#/definitions/ContractionParameters"
            }
          ]
        },
        "overlay_simplification": {
          "description": "How to simplify the edges TTFs after the hierarchy overlay is built.",
          "allOf": [
            {
              "$ref": "#/definitions/TTFSimplification_for_Time_for_double"
            }
          ]
        },
        "recording_interval": {
          "description": "Interval in time for which the bottleneck and road segment travel times are aggregated.",
          "allOf": [
            {
              "$ref": "#/definitions/Time_for_double"
            }
          ]
        },
        "search_space_simplification": {
          "description": "How to simplify the TTFs of the forward and backward search spaces.",
          "allOf": [
            {
              "$ref": "#/definitions/TTFSimplification_for_Time_for_double"
            }
          ]
        },
        "simulated_simplification": {
          "description": "How to simplify the edges TTFs at the end of the within-day model.",
          "allOf": [
            {
              "$ref": "#/definitions/TTFSimplification_for_Time_for_double"
            }
          ]
        },
        "weight_simplification": {
          "description": "How to simplify the edges TTFs at the beginning of the iteration.",
          "allOf": [
            {
              "$ref": "#/definitions/TTFSimplification_for_Time_for_double"
            }
          ]
        }
      }
    },
    "StopCriterion_for_double": {
      "description": "Criterion that is used to check if a simulation must be stopped.",
      "oneOf": [
        {
          "description": "Stop when the number of iterations has reached a given value.",
          "type": "object",
          "required": [
            "type",
            "value"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "MaxIteration"
              ]
            },
            "value": {
              "type": "integer",
              "format": "uint32",
              "minimum": 0.0
            }
          }
        },
        {
          "description": "Stop when the mean departure-time shift from one iteration to another is below a threshold value.\n\nThe first value represents the threshold value. The second value represents the backup value to use when an agent switch from a mode to another mode.",
          "type": "object",
          "required": [
            "type",
            "value"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "DepartureTime"
              ]
            },
            "value": {
              "type": "array",
              "items": [
                {
                  "$ref": "#/definitions/Time_for_double"
                },
                {
                  "$ref": "#/definitions/Time_for_double"
                }
              ],
              "maxItems": 2,
              "minItems": 2
            }
          }
        }
      ]
    },
    "TTFSimplification_for_Time_for_double": {
      "description": "Description of a method to simplify a TTF.",
      "oneOf": [
        {
          "description": "No simplification is done.",
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Raw"
              ]
            }
          }
        },
        {
          "description": "Allow for a given error bound.",
          "type": "object",
          "required": [
            "type",
            "value"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Bound"
              ]
            },
            "value": {
              "$ref": "#/definitions/Time_for_double"
            }
          }
        },
        {
          "description": "Compute the values at fixed intervals.",
          "type": "object",
          "required": [
            "type",
            "value"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "Interval"
              ]
            },
            "value": {
              "$ref": "#/definitions/Time_for_double"
            }
          }
        }
      ]
    },
    "Time_for_double": {
      "description": "Representation of time duration or timestamp, expressed in seconds.",
      "type": "number",
      "format": "double"
    }
  }
}